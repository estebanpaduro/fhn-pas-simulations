(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     25136,        487]
NotebookOptionsPosition[     24603,        470]
NotebookOutlinePosition[     25084,        488]
CellTagsIndexPosition[     25041,        485]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Heatmap", " ", "of", " ", "A", " ", "vs", " ", "B", " ", "with", " ", 
    "fixed", " ", "\[Eta]", " ", "for", " ", "the", " ", "Partially", " ", 
    "averaged", " ", "system"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"From", " ", 
    RowBox[{"article", ":", " ", 
     RowBox[{
     "A", " ", "partially", " ", "averaged", " ", "system", " ", "to", " ", 
      "model", " ", "neuron", " ", "responses", " ", "to", " ", 
      "interferential", " ", "current", " ", "stimulation"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Cerpa", " ", 
     RowBox[{"E", "."}]}], ",", " ", 
    RowBox[{"Courdurier", " ", 
     RowBox[{"M", "."}]}], ",", " ", 
    RowBox[{"Hernandez", " ", 
     RowBox[{"E", "."}]}], ",", " ", 
    RowBox[{"Medina", " ", 
     RowBox[{"L", "."}]}], ",", " ", 
    RowBox[{"Paduro", " ", 
     RowBox[{"E", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{
    "simulation", ",", "ep", ",", "\[Gamma]", ",", "\[Beta]", ",", "freq", 
     ",", "filename", ",", "\[Eta]", ",", "maxtime", ",", "eql", ",", "v", 
     ",", "w", ",", "v0", ",", "w0", ",", "Va", ",", "Wa", ",", "t", ",", 
     "peaks", ",", " ", "count", ",", " ", "point", ",", "data", ",", 
     "headers", ",", "extract"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Begin", " ", "simulation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ep", "=", "0.08"}], ";", 
    RowBox[{"\[Gamma]", "=", "0.5"}], ";", 
    RowBox[{"\[Beta]", "=", "0.8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"simulation", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"filename", "=", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<data_fig5_\>\"", ",", 
         RowBox[{"ToString", "[", "freq", "]"}], ",", "\"\<hz.csv\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"2", "Pi", " ", 
        RowBox[{"freq", "/", "1000"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"maxtime", "=", "1000"}], ";", 
      RowBox[{"(*", 
       RowBox[{"In", " ", "miliseconds"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Critical", " ", "Points"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"eql", " ", "=", " ", 
            RowBox[{"NSolve", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"v", "-", 
                  RowBox[{
                   RowBox[{"v", "^", "3"}], "/", "3"}], "-", "w"}], 
                 "\[Equal]", "0"}], ",", 
                RowBox[{
                 RowBox[{"ep", 
                  RowBox[{"(", 
                   RowBox[{"v", "-", 
                    RowBox[{"\[Gamma]", " ", "w"}], " ", "+", " ", 
                    "\[Beta]"}], ")"}]}], "\[Equal]", "0"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"v", ",", "w"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v0", ",", "w0"}], "}"}], "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"v", ",", "w"}], "}"}], "/.", 
             RowBox[{"eql", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Averaged", " ", "FHN"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Va", ",", "Wa"}], "}"}], "=", 
            RowBox[{"NDSolveValue", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"v", "'"}], "[", "t", "]"}], "\[Equal]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"A", "^", "2"}], "/", "2"}], "-", 
                    RowBox[{
                    RowBox[{"B", "^", "2"}], "/", "2"}], "-", 
                    RowBox[{"A", " ", "B", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Eta]", " ", "t"}], "]"}]}]}], ")"}], 
                   RowBox[{"v", "[", "t", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"v", "[", "t", "]"}], "^", "3"}], "/", "3"}], "-", 
                  RowBox[{"w", "[", "t", "]"}]}]}], " ", ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"w", "'"}], "[", "t", "]"}], "==", 
                 RowBox[{"ep", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"v", "[", "t", "]"}], "-", 
                    RowBox[{"\[Gamma]", " ", 
                    RowBox[{"w", "[", "t", "]"}]}], " ", "+", " ", 
                    "\[Beta]"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"v", "[", "0", "]"}], "\[Equal]", "v0"}], ",", 
                RowBox[{
                 RowBox[{"w", "[", "0", "]"}], "\[Equal]", "w0"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"v", ",", "w"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "0", ",", "maxtime"}], "}"}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"peaks", " ", "=", " ", 
            RowBox[{"FindPeaks", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Va", "[", "t", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "maxtime", ",", "1"}], "}"}]}], 
               "]"}], ",", "0", ",", "0", ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "To", " ", "avoid", " ", "multiple", " ", "counting", " ", 
             "local", " ", "maxima", " ", "we", " ", "filter", " ", "peaks", 
             " ", "that", " ", "are", " ", "less", " ", "than", " ", 
             RowBox[{"5", "[", "ms", "]"}], " ", "away"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "peaks", "]"}], ">", "0"}], ",", 
             RowBox[{"count", "=", 
              RowBox[{
               RowBox[{"Total", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"Boole", "[", 
                    RowBox[{"#", ">=", "5"}], "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"peaks", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "1"}]}], ",", "1"}], "]"}], "]"}], "-", 
                   RowBox[{"peaks", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", 
                    RowBox[{"-", "2"}]}], ",", "1"}], "]"}], "]"}]}]}], "]"}],
                 "]"}], "+", "1"}]}], ",", 
             RowBox[{"count", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"point", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"A", ",", "B", ",", "freq", ",", 
              RowBox[{
               RowBox[{"count", "/", "maxtime"}], "*", "1000"}]}], "}"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"simulation", " ", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"simulation", ",", "point"}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", "0", ",", "1.5", ",", "0.02"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"B", ",", "0", ",", "1.5", ",", "0.02"}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Export", " ", "Results", " ", "to", " ", "a", " ", "csv", " ", "file",
         " ", "to", " ", "be", " ", "plotted", " ", "using", " ", 
        "matplotlib", " ", "library", " ", "in", " ", "python"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"SetDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"filename", ",", "simulation"}], "]"}], ";", "\n", 
      RowBox[{"data", "=", 
       RowBox[{"Import", "[", "filename", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"headers", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<freq\>\"", ",", 
         "\"\<spikerate\>\""}], "}"}]}], ";", "\n", 
      RowBox[{"data", " ", "=", " ", 
       RowBox[{"Prepend", "[", 
        RowBox[{"data", ",", "headers"}], "]"}]}], ";", "\n", 
      RowBox[{"Export", "[", 
       RowBox[{"filename", ",", "data"}], "]"}], ";"}], "\[IndentingNewLine]",
      ",", 
     RowBox[{"{", 
      RowBox[{"freq", ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "50", ",", "80", ",", "120"}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8365764195893507`*^9, 3.8365764829171247`*^9}, {
   3.836576563195706*^9, 3.83657656781206*^9}, {3.836576613744201*^9, 
   3.8365766304744773`*^9}, {3.836576673277386*^9, 3.8365766762242303`*^9}, {
   3.836576756596757*^9, 3.8365768620848365`*^9}, {3.8365769238733177`*^9, 
   3.836577092849555*^9}, {3.836577134450241*^9, 3.8365771807249537`*^9}, {
   3.8365772331972375`*^9, 3.8365772622701263`*^9}, {3.8365773053024683`*^9, 
   3.8365773118437157`*^9}, {3.8365779758994503`*^9, 3.836578267409032*^9}, {
   3.8365799276423674`*^9, 3.8365799589959183`*^9}, {3.8365801829034986`*^9, 
   3.8365803231632805`*^9}, {3.83658036364727*^9, 3.836580365789157*^9}, {
   3.836580435003389*^9, 3.8365805925812736`*^9}, {3.836580631234239*^9, 
   3.836580727700471*^9}, {3.8365807679908*^9, 3.836580804094198*^9}, {
   3.8365808533515635`*^9, 3.836580954574869*^9}, {3.836580987961808*^9, 
   3.8365810017316155`*^9}, {3.8365813186628532`*^9, 
   3.8365814528246155`*^9}, {3.8365814847677407`*^9, 
   3.8365814946075363`*^9}, {3.836581664416989*^9, 3.8365816686415854`*^9}, {
   3.8365817091627893`*^9, 3.836581794425687*^9}, {3.836581827983651*^9, 
   3.8365818675145864`*^9}, {3.836581924077717*^9, 3.8365819242084675`*^9}, {
   3.836581954787426*^9, 3.8365821415199475`*^9}, {3.8365832033485312`*^9, 
   3.836583215570546*^9}, {3.836583262961662*^9, 3.836583324434626*^9}, {
   3.8365833783917933`*^9, 3.8365834439630885`*^9}, {3.836583476393632*^9, 
   3.836583601730036*^9}, {3.8365836490918875`*^9, 3.8365836492586555`*^9}, {
   3.8365838096790094`*^9, 3.836584040103962*^9}, {3.836584108502695*^9, 
   3.836584125222884*^9}, {3.836584197058638*^9, 3.8365842237479577`*^9}, {
   3.836584254396799*^9, 3.836584634019613*^9}, {3.83658468412457*^9, 
   3.8365847126167297`*^9}, {3.83658477666457*^9, 3.8365847964099884`*^9}, {
   3.8365857669190836`*^9, 3.8365858224996667`*^9}, {3.836586167908511*^9, 
   3.8365861688613625`*^9}, {3.836586220960807*^9, 3.8365862475982227`*^9}, {
   3.8365905327558355`*^9, 3.8365905550983243`*^9}, {3.8365906499048123`*^9, 
   3.8365906561725283`*^9}, {3.836590716641168*^9, 3.8365907651284957`*^9}, {
   3.836590806435878*^9, 3.836590811631076*^9}, {3.8365908443436766`*^9, 
   3.8365911279233017`*^9}, {3.8365911991492863`*^9, 3.836591204615698*^9}, {
   3.8365912610885863`*^9, 3.8365912822445087`*^9}, {3.8365913174250154`*^9, 
   3.836591352109292*^9}, {3.8365914495056806`*^9, 3.836591498030156*^9}, {
   3.8365915371297426`*^9, 3.8365915554655848`*^9}, {3.8365916699752483`*^9, 
   3.8365917661641226`*^9}, {3.8365919476083837`*^9, 
   3.8365920006576614`*^9}, {3.836592218483713*^9, 3.8365922541401367`*^9}, {
   3.836592638922042*^9, 3.836592639057246*^9}, {3.836592703174262*^9, 
   3.8365928285061493`*^9}, {3.836592860794361*^9, 3.8365928757700443`*^9}, {
   3.836592943432811*^9, 3.8365930241894464`*^9}, {3.836593057141816*^9, 
   3.83659306370382*^9}, {3.8365931007891293`*^9, 3.836593133677662*^9}, {
   3.8366523162536545`*^9, 3.8366523249447737`*^9}, {3.836654217715496*^9, 
   3.836654246837434*^9}, {3.837792234654108*^9, 3.8377922356688366`*^9}, {
   3.8377923063599358`*^9, 3.8377923227767906`*^9}, {3.8377923677255244`*^9, 
   3.83779238795697*^9}, {3.837792510609088*^9, 3.8377925246316833`*^9}, {
   3.8377926149525433`*^9, 3.837792644798376*^9}, {3.837792686529766*^9, 
   3.837792718350808*^9}, {3.83839659340462*^9, 3.8383966010277824`*^9}, {
   3.8383968559512415`*^9, 3.8383968561966505`*^9}, {3.8383969170638657`*^9, 
   3.8383969272317424`*^9}, {3.8383970596048994`*^9, 
   3.8383971977668586`*^9}, {3.8383975068086557`*^9, 3.8383975208466*^9}, {
   3.838397557159333*^9, 3.8383978039915676`*^9}, {3.838397864960954*^9, 
   3.8383979259599185`*^9}, {3.838397975641676*^9, 3.838398046610136*^9}, {
   3.8383980882109013`*^9, 3.8383981087070093`*^9}, {3.838398208380371*^9, 
   3.8383983334241314`*^9}, {3.838836860727124*^9, 3.838836874659139*^9}, {
   3.838838389570651*^9, 3.8388384077931156`*^9}, {3.838838458496623*^9, 
   3.838838482255479*^9}, {3.8388385144508505`*^9, 3.838838671188246*^9}, {
   3.8388387728685603`*^9, 3.838838774662985*^9}, {3.8388388331654835`*^9, 
   3.838838889082362*^9}, {3.83883907946988*^9, 3.8388390932246094`*^9}, {
   3.838839128823948*^9, 3.8388391324538183`*^9}, {3.838839279613885*^9, 
   3.8388393542391505`*^9}, {3.838839397250336*^9, 3.8388393982109833`*^9}, 
   3.8388394320566025`*^9, {3.838839856867484*^9, 3.8388398585553637`*^9}, {
   3.8388399493454895`*^9, 3.8388400083362613`*^9}, {3.838979769865878*^9, 
   3.8389797809628744`*^9}, {3.8389799686662846`*^9, 
   3.8389800165308323`*^9}, {3.838980052213981*^9, 3.838980100967993*^9}, {
   3.8389803466206264`*^9, 3.838980377139561*^9}, {3.8389805293375573`*^9, 
   3.83898054982156*^9}, {3.838980642216855*^9, 3.8389806423202753`*^9}, 
   3.838980704633724*^9, {3.8389807361943846`*^9, 3.838980748573292*^9}, {
   3.838980876292096*^9, 3.8389809839855204`*^9}, {3.8389810343723817`*^9, 
   3.838981052319965*^9}, 3.8389811004057503`*^9, {3.838981176444544*^9, 
   3.838981256967248*^9}, {3.8389813364850674`*^9, 3.8389813476963167`*^9}, {
   3.8389813957643557`*^9, 3.8389814613958*^9}, {3.8389815738824406`*^9, 
   3.8389817489437704`*^9}, {3.838981948449819*^9, 3.838981950067354*^9}, {
   3.8393569649308805`*^9, 3.8393570699138064`*^9}, {3.839357145852449*^9, 
   3.839357203960518*^9}, {3.839357243932632*^9, 3.839357245242231*^9}, {
   3.839357301620901*^9, 3.8393573924278097`*^9}, 3.8393575132826953`*^9, {
   3.8393578552416534`*^9, 3.8393578618338766`*^9}, {3.839359320753386*^9, 
   3.839359346059767*^9}, {3.8393602026475353`*^9, 3.8393603017881517`*^9}, {
   3.83942809688715*^9, 3.839428212806492*^9}, {3.839431958981122*^9, 
   3.8394319803254495`*^9}, {3.839432037258*^9, 3.839432037326642*^9}, {
   3.839432103121444*^9, 3.8394321048239503`*^9}, {3.839432192428586*^9, 
   3.8394322066447754`*^9}, 3.839432239299589*^9, {3.8394323138493767`*^9, 
   3.839432327665306*^9}, 3.839432358994463*^9, {3.8394324578248467`*^9, 
   3.839432484932979*^9}, {3.8394325763910303`*^9, 3.839432580582559*^9}, {
   3.8395187798007283`*^9, 3.839518821909912*^9}, 3.839518875148583*^9, {
   3.8395189756913643`*^9, 3.839519082359242*^9}, {3.839519142004547*^9, 
   3.83951919207831*^9}, {3.839521780848177*^9, 3.839521806500095*^9}, {
   3.839521909589226*^9, 3.839521942996363*^9}, 3.839521998750819*^9, {
   3.8395220340562534`*^9, 3.839522137944013*^9}, {3.8395221709951324`*^9, 
   3.839522192882758*^9}, {3.8395226579532137`*^9, 3.839522696360197*^9}, {
   3.8395826535799284`*^9, 3.839582653706676*^9}, {3.8395908605463037`*^9, 
   3.839590888980703*^9}, 3.8395911739930162`*^9, {3.839591945299534*^9, 
   3.8395919454428864`*^9}, {3.8395921959806433`*^9, 3.839592199438594*^9}, {
   3.839592259623151*^9, 3.8395922858329473`*^9}, 3.8395923514520254`*^9, {
   3.839592471473362*^9, 3.839592471619735*^9}, {3.8395926209422183`*^9, 
   3.8395926753464713`*^9}, {3.839592749561859*^9, 3.8395927934024334`*^9}, {
   3.8395928637606916`*^9, 3.839592884851223*^9}, 3.839592942425869*^9, {
   3.8453893561874948`*^9, 3.8453893759246407`*^9}, 3.8453894263915596`*^9, 
   3.8453894584906197`*^9, {3.845389494596809*^9, 3.8453895641587124`*^9}, {
   3.845389615615509*^9, 3.845389636001499*^9}, {3.8453897233042407`*^9, 
   3.845389780695845*^9}, {3.8453898387305984`*^9, 3.845389859119454*^9}, {
   3.8453899149733143`*^9, 3.8453900670892878`*^9}, {3.845566786704673*^9, 
   3.8455668218665323`*^9}, {3.845566889937372*^9, 3.845567070483631*^9}, {
   3.845567205119375*^9, 3.845567213128336*^9}, {3.845567270118438*^9, 
   3.8455672847079535`*^9}, {3.8455673998663225`*^9, 3.845567422651112*^9}, {
   3.845567577458933*^9, 3.845567613963456*^9}, {3.845567871549438*^9, 
   3.8455679832961097`*^9}, {3.845568148568243*^9, 3.845568170566583*^9}, {
   3.8456304445049973`*^9, 3.845630479582086*^9}, {3.8456306000433197`*^9, 
   3.8456307250885057`*^9}, {3.845630779736402*^9, 3.8456308204754343`*^9}, {
   3.8456310787967243`*^9, 3.8456310919076695`*^9}, {3.845631128100527*^9, 
   3.8456312335194435`*^9}, {3.8456343430696*^9, 3.845634630815278*^9}, {
   3.8456348382077303`*^9, 3.8456348438216405`*^9}, {3.8459770660693574`*^9, 
   3.845977066537086*^9}, {3.8472883491220675`*^9, 3.847288353071735*^9}, {
   3.847293951910957*^9, 3.8472940000342283`*^9}, {3.847369599941907*^9, 
   3.847369645972349*^9}, {3.8473697746024895`*^9, 3.8473698040242796`*^9}, {
   3.8473698471913643`*^9, 3.847369847289497*^9}, 3.847369946428907*^9, 
   3.84737008205167*^9, {3.8473702016551113`*^9, 3.847370201905573*^9}, 
   3.847370334174654*^9, 3.847370422851432*^9, 3.8473705138336735`*^9, 
   3.847370614840253*^9, 3.8473707316113157`*^9, {3.8473707946987696`*^9, 
   3.847370797494799*^9}, {3.847370931515792*^9, 3.8473709318668118`*^9}, {
   3.84737412928251*^9, 3.8473741451995263`*^9}, 3.847374208667549*^9, 
   3.8473744098477116`*^9, {3.8473770294785805`*^9, 3.847377029585231*^9}, {
   3.8473778917848988`*^9, 3.8473778930217953`*^9}, {3.8479000425129766`*^9, 
   3.847900042577018*^9}, 3.847900310904811*^9, {3.8479006577422457`*^9, 
   3.8479006578387623`*^9}, {3.8617348427056456`*^9, 
   3.8617348447702703`*^9}, {3.861734991224642*^9, 3.861735010053316*^9}, {
   3.8618024797405148`*^9, 3.8618025977033267`*^9}, {3.8618026894754176`*^9, 
   3.8618026905335827`*^9}, {3.8618027457064276`*^9, 3.861802759882833*^9}, {
   3.8618027944151187`*^9, 3.8618028245509114`*^9}, 3.8618031150264797`*^9, {
   3.8618032040145626`*^9, 3.861803208142497*^9}, {3.8618033446206636`*^9, 
   3.8618034494954214`*^9}, {3.8618035397063646`*^9, 
   3.8618035400189295`*^9}, {3.8618045858875475`*^9, 
   3.8618045947158537`*^9}, {3.8618049155129743`*^9, 3.861804925049838*^9}, {
   3.861808556923205*^9, 3.861808560547177*^9}, {3.861808751120308*^9, 
   3.8618087511736703`*^9}, {3.8618092813967724`*^9, 3.8618092827877245`*^9}, 
   3.8618094385038157`*^9, {3.861809475572167*^9, 3.8618094945172596`*^9}, {
   3.8618100749558907`*^9, 3.861810077838239*^9}, {3.8618102441528254`*^9, 
   3.8618102473680086`*^9}, {3.8618103527115974`*^9, 3.861810355355487*^9}, {
   3.861824540138179*^9, 3.8618245441853094`*^9}, {3.8618246713986073`*^9, 
   3.861824673778083*^9}, {3.8618248077703953`*^9, 3.861824807930975*^9}, {
   3.861825043356616*^9, 3.861825045875062*^9}, {3.86182567527553*^9, 
   3.8618256774625535`*^9}, {3.862052626274395*^9, 3.8620527821017036`*^9}, {
   3.8620529965923815`*^9, 3.8620530313500204`*^9}, {3.862053175420288*^9, 
   3.8620531966402035`*^9}, {3.862053278587183*^9, 3.8620532954076014`*^9}, {
   3.862053415420931*^9, 3.8620534187824025`*^9}, {3.8620546860606833`*^9, 
   3.8620546895768538`*^9}, {3.862054722715335*^9, 3.862054848559208*^9}, 
   3.862054884090828*^9, {3.8620550066362705`*^9, 3.8620550098385954`*^9}, {
   3.8624330921754785`*^9, 3.86243309436837*^9}, {3.8624343862646737`*^9, 
   3.862434386428875*^9}, {3.862434423830224*^9, 3.862434431860384*^9}, 
   3.8769828545071487`*^9, {3.8772550753618135`*^9, 3.8772551035811615`*^9}, {
   3.8772559034377065`*^9, 3.8772559319318357`*^9}, {3.877255984978383*^9, 
   3.877255991727324*^9}, {3.877256997768941*^9, 
   3.8772569978319607`*^9}},ExpressionUUID->"ed15d148-733c-4386-9344-\
7eadc13d9f93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Preview", " ", "of", " ", "the", " ", "results"}], ",", " ", 
    RowBox[{
    "the", " ", "final", " ", "plot", " ", "is", " ", "generated", " ", "in", 
     " ", "python"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"extract", "=", 
     RowBox[{"simulation", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ListDensityPlot", "[", 
    RowBox[{"extract", ",", 
     RowBox[{"Mesh", "->", "All"}], ",", 
     RowBox[{"InterpolationOrder", "->", "0"}], ",", 
     RowBox[{"PlotLegends", "->", 
      RowBox[{"BarLegend", "[", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "30"}], "}"}]}], "}"}], "]"}]}], ",", 
     RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{"Full", ",", "Full", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "30"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotRangeClipping", "->", "False"}], ",", 
     RowBox[{"ColorFunction", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<SunsetColors\>\"", "]"}], "[", 
         RowBox[{
          RowBox[{"0.9", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"#", "/", "30"}]}], ")"}]}], "+", "0.07"}], "]"}], "&"}],
        ")"}]}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8456346778211527`*^9, 3.8456346845948944`*^9}, {
   3.8456347471161594`*^9, 3.8456347972588315`*^9}, 3.847369738236401*^9, {
   3.8618036600549707`*^9, 3.861803695716443*^9}, {3.861803760929441*^9, 
   3.8618037858832307`*^9}, {3.86180381744998*^9, 3.8618038445177226`*^9}, {
   3.8618040332178802`*^9, 3.8618040333511195`*^9}, {3.861804276065995*^9, 
   3.861804296282627*^9}, 3.8618045067454762`*^9, {3.861804551547387*^9, 
   3.861804568416184*^9}, {3.861804839581668*^9, 3.861804888570819*^9}, {
   3.8618053538827066`*^9, 3.861805428388216*^9}, {3.8618054733516464`*^9, 
   3.86180551027674*^9}, {3.8618067933795676`*^9, 3.8618069533219213`*^9}, {
   3.861807020348223*^9, 3.861807057163072*^9}, {3.8618071264851274`*^9, 
   3.8618071468649607`*^9}, {3.8618071821351933`*^9, 3.861807352142397*^9}, {
   3.861807423388533*^9, 3.8618074236734548`*^9}, {3.8618075742978444`*^9, 
   3.8618076128856435`*^9}, {3.8618076794239326`*^9, 
   3.8618077342857943`*^9}, {3.8618078384479246`*^9, 
   3.8618078421126547`*^9}, {3.8618078950557103`*^9, 3.861807989526827*^9}, {
   3.8618080221849527`*^9, 3.8618081102599645`*^9}, {3.861808143352233*^9, 
   3.861808155595492*^9}, {3.861808189542017*^9, 3.861808191931387*^9}, {
   3.861808226686137*^9, 3.861808313849449*^9}, {3.8618083453515434`*^9, 
   3.8618084730355415`*^9}, {3.861808701685779*^9, 3.8618087034839344`*^9}, {
   3.861810869111821*^9, 3.8618108869411945`*^9}, {3.8620530371281276`*^9, 
   3.862053054929042*^9}, {3.862054575102573*^9, 3.862054577284746*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"cb55f92b-0108-47d1-b608-f2e5ed016aa2"]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.1 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4174d29f-7282-4c17-90e3-b387d57b1530"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 20772, 378, 723, "Input",ExpressionUUID->"ed15d148-733c-4386-9344-7eadc13d9f93"],
Cell[21333, 400, 3266, 68, 115, "Input",ExpressionUUID->"cb55f92b-0108-47d1-b608-f2e5ed016aa2"]
}
]
*)

