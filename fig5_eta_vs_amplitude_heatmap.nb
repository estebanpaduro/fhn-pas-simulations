(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     21751,        429]
NotebookOptionsPosition[     21249,        413]
NotebookOutlinePosition[     21700,        430]
CellTagsIndexPosition[     21657,        427]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Heatmap", " ", "of", " ", "\[Eta]", " ", "vs", " ", "amplitude", " ", 
    "for", " ", "the", " ", "Partially", " ", "averaged", " ", "system"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"From", " ", 
    RowBox[{"article", ":", " ", 
     RowBox[{
     "A", " ", "partially", " ", "averaged", " ", "system", " ", "to", " ", 
      "model", " ", "neuron", " ", "responses", " ", "to", " ", 
      "interferential", " ", "current", " ", "stimulation"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Cerpa", " ", 
     RowBox[{"E", "."}]}], ",", " ", 
    RowBox[{"Courdurier", " ", 
     RowBox[{"M", "."}]}], ",", " ", 
    RowBox[{"Hernandez", " ", 
     RowBox[{"E", "."}]}], ",", " ", 
    RowBox[{"Medina", " ", 
     RowBox[{"L", "."}]}], ",", " ", 
    RowBox[{"Paduro", " ", 
     RowBox[{"E", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{
    "simulation", ",", "filename", ",", "ep", ",", "\[Gamma]", ",", "\[Beta]",
      ",", "amplitude", ",", "A", ",", "B", ",", "freq", ",", "\[Eta]", ",", 
     "maxtime", ",", "eql", ",", "v0", ",", "w0", ",", "Va", ",", "Wa", ",", 
     "v", ",", "w", ",", "peaks", ",", "count", ",", "point", ",", "data", 
     ",", " ", "headers", ",", "extract"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Begin", " ", "simulation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simulation", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"filename", "=", "\"\<simulation_low_frequency.csv\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ep", "=", "0.08"}], ";", 
        RowBox[{"\[Gamma]", "=", "0.5"}], ";", 
        RowBox[{"\[Beta]", "=", "0.8"}], ";", "\[IndentingNewLine]", 
        RowBox[{"A", " ", "=", " ", "amplitude"}], ";", "\[IndentingNewLine]", 
        RowBox[{"B", " ", "=", "amplitude"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Eta]", "=", 
         RowBox[{"2", "Pi", " ", 
          RowBox[{"freq", "/", "1000"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"maxtime", "=", "1000"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Critical", " ", "Points"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"eql", " ", "=", " ", 
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "-", 
               RowBox[{
                RowBox[{"v", "^", "3"}], "/", "3"}], "-", "w"}], "\[Equal]", 
              "0"}], ",", 
             RowBox[{
              RowBox[{"ep", 
               RowBox[{"(", 
                RowBox[{"v", "-", 
                 RowBox[{"\[Gamma]", " ", "w"}], " ", "+", " ", "\[Beta]"}], 
                ")"}]}], "\[Equal]", "0"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v", ",", "w"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Use", " ", "one", " ", "of", " ", "them", " ", "as", " ", 
          "starting", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v0", ",", "w0"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v", ",", "w"}], "}"}], "/.", 
          RowBox[{"eql", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Averaged", " ", "FHN"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Va", ",", "Wa"}], "}"}], "=", 
         RowBox[{"NDSolveValue", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"v", "'"}], "[", "t", "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"A", "^", "2"}], "/", "2"}], "-", 
                  RowBox[{
                   RowBox[{"B", "^", "2"}], "/", "2"}], "-", 
                  RowBox[{"A", " ", "B", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Eta]", " ", "t"}], "]"}]}]}], ")"}], 
                RowBox[{"v", "[", "t", "]"}]}], "-", 
               RowBox[{
                RowBox[{
                 RowBox[{"v", "[", "t", "]"}], "^", "3"}], "/", "3"}], "-", 
               RowBox[{"w", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"w", "'"}], "[", "t", "]"}], "==", 
              RowBox[{"ep", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"v", "[", "t", "]"}], "-", 
                 RowBox[{"\[Gamma]", " ", 
                  RowBox[{"w", "[", "t", "]"}]}], " ", "+", " ", "\[Beta]"}], 
                ")"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"v", "[", "0", "]"}], "\[Equal]", "v0"}], ",", 
             RowBox[{
              RowBox[{"w", "[", "0", "]"}], "\[Equal]", "w0"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v", ",", "w"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "maxtime"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"peaks", " ", "=", " ", 
         RowBox[{"FindPeaks", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Va", "[", "t", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0", ",", "maxtime", ",", "1"}], "}"}]}], 
            "]"}], ",", "0", ",", "0", ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"count", "=", 
         RowBox[{"Length", "[", "peaks", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"point", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"amplitude", ",", "freq", ",", 
           RowBox[{
            RowBox[{"count", "/", "maxtime"}], "*", "1000"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"simulation", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"simulation", ",", "point"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"freq", ",", "0", ",", "200", ",", "10"}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"amplitude", ",", "0", ",", "3", ",", "0.01"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Export", " ", "Results", " ", "to", " ", "a", " ", "csv", " ", "file", 
     " ", "to", " ", "be", " ", "plotted", " ", "using", " ", "matplotlib", 
     " ", "library", " ", "in", " ", "python"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"filename", ",", "simulation"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Import", "[", "filename", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"headers", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<amplitude\>\"", ",", "\"\<freq\>\"", ",", "\"\<spikerate\>\""}], 
      "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"data", " ", "=", " ", 
     RowBox[{"Prepend", "[", 
      RowBox[{"data", ",", "headers"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"filename", ",", "data"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8365764195893507`*^9, 3.8365764829171247`*^9}, {
   3.836576563195706*^9, 3.83657656781206*^9}, {3.836576613744201*^9, 
   3.8365766304744773`*^9}, {3.836576673277386*^9, 3.8365766762242303`*^9}, {
   3.836576756596757*^9, 3.8365768620848365`*^9}, {3.8365769238733177`*^9, 
   3.836577092849555*^9}, {3.836577134450241*^9, 3.8365771807249537`*^9}, {
   3.8365772331972375`*^9, 3.8365772622701263`*^9}, {3.8365773053024683`*^9, 
   3.8365773118437157`*^9}, {3.8365779758994503`*^9, 3.836578267409032*^9}, {
   3.8365799276423674`*^9, 3.8365799589959183`*^9}, {3.8365801829034986`*^9, 
   3.8365803231632805`*^9}, {3.83658036364727*^9, 3.836580365789157*^9}, {
   3.836580435003389*^9, 3.8365805925812736`*^9}, {3.836580631234239*^9, 
   3.836580727700471*^9}, {3.8365807679908*^9, 3.836580804094198*^9}, {
   3.8365808533515635`*^9, 3.836580954574869*^9}, {3.836580987961808*^9, 
   3.8365810017316155`*^9}, {3.8365813186628532`*^9, 
   3.8365814528246155`*^9}, {3.8365814847677407`*^9, 
   3.8365814946075363`*^9}, {3.836581664416989*^9, 3.8365816686415854`*^9}, {
   3.8365817091627893`*^9, 3.836581794425687*^9}, {3.836581827983651*^9, 
   3.8365818675145864`*^9}, {3.836581924077717*^9, 3.8365819242084675`*^9}, {
   3.836581954787426*^9, 3.8365821415199475`*^9}, {3.8365832033485312`*^9, 
   3.836583215570546*^9}, {3.836583262961662*^9, 3.836583324434626*^9}, {
   3.8365833783917933`*^9, 3.8365834439630885`*^9}, {3.836583476393632*^9, 
   3.836583601730036*^9}, {3.8365836490918875`*^9, 3.8365836492586555`*^9}, {
   3.8365838096790094`*^9, 3.836584040103962*^9}, {3.836584108502695*^9, 
   3.836584125222884*^9}, {3.836584197058638*^9, 3.8365842237479577`*^9}, {
   3.836584254396799*^9, 3.836584634019613*^9}, {3.83658468412457*^9, 
   3.8365847126167297`*^9}, {3.83658477666457*^9, 3.8365847964099884`*^9}, {
   3.8365857669190836`*^9, 3.8365858224996667`*^9}, {3.836586167908511*^9, 
   3.8365861688613625`*^9}, {3.836586220960807*^9, 3.8365862475982227`*^9}, {
   3.8365905327558355`*^9, 3.8365905550983243`*^9}, {3.8365906499048123`*^9, 
   3.8365906561725283`*^9}, {3.836590716641168*^9, 3.8365907651284957`*^9}, {
   3.836590806435878*^9, 3.836590811631076*^9}, {3.8365908443436766`*^9, 
   3.8365911279233017`*^9}, {3.8365911991492863`*^9, 3.836591204615698*^9}, {
   3.8365912610885863`*^9, 3.8365912822445087`*^9}, {3.8365913174250154`*^9, 
   3.836591352109292*^9}, {3.8365914495056806`*^9, 3.836591498030156*^9}, {
   3.8365915371297426`*^9, 3.8365915554655848`*^9}, {3.8365916699752483`*^9, 
   3.8365917661641226`*^9}, {3.8365919476083837`*^9, 
   3.8365920006576614`*^9}, {3.836592218483713*^9, 3.8365922541401367`*^9}, {
   3.836592638922042*^9, 3.836592639057246*^9}, {3.836592703174262*^9, 
   3.8365928285061493`*^9}, {3.836592860794361*^9, 3.8365928757700443`*^9}, {
   3.836592943432811*^9, 3.8365930241894464`*^9}, {3.836593057141816*^9, 
   3.83659306370382*^9}, {3.8365931007891293`*^9, 3.836593133677662*^9}, {
   3.8366523162536545`*^9, 3.8366523249447737`*^9}, {3.836654217715496*^9, 
   3.836654246837434*^9}, {3.837792234654108*^9, 3.8377922356688366`*^9}, {
   3.8377923063599358`*^9, 3.8377923227767906`*^9}, {3.8377923677255244`*^9, 
   3.83779238795697*^9}, {3.837792510609088*^9, 3.8377925246316833`*^9}, {
   3.8377926149525433`*^9, 3.837792644798376*^9}, {3.837792686529766*^9, 
   3.837792718350808*^9}, {3.83839659340462*^9, 3.8383966010277824`*^9}, {
   3.8383968559512415`*^9, 3.8383968561966505`*^9}, {3.8383969170638657`*^9, 
   3.8383969272317424`*^9}, {3.8383970596048994`*^9, 
   3.8383971977668586`*^9}, {3.8383975068086557`*^9, 3.8383975208466*^9}, {
   3.838397557159333*^9, 3.8383978039915676`*^9}, {3.838397864960954*^9, 
   3.8383979259599185`*^9}, {3.838397975641676*^9, 3.838398046610136*^9}, {
   3.8383980882109013`*^9, 3.8383981087070093`*^9}, {3.838398208380371*^9, 
   3.8383983334241314`*^9}, {3.838836860727124*^9, 3.838836874659139*^9}, {
   3.838838389570651*^9, 3.8388384077931156`*^9}, {3.838838458496623*^9, 
   3.838838482255479*^9}, {3.8388385144508505`*^9, 3.838838671188246*^9}, {
   3.8388387728685603`*^9, 3.838838774662985*^9}, {3.8388388331654835`*^9, 
   3.838838889082362*^9}, {3.83883907946988*^9, 3.8388390932246094`*^9}, {
   3.838839128823948*^9, 3.8388391324538183`*^9}, {3.838839279613885*^9, 
   3.8388393542391505`*^9}, {3.838839397250336*^9, 3.8388393982109833`*^9}, 
   3.8388394320566025`*^9, {3.838839856867484*^9, 3.8388398585553637`*^9}, {
   3.8388399493454895`*^9, 3.8388400083362613`*^9}, {3.838979769865878*^9, 
   3.8389797809628744`*^9}, {3.8389799686662846`*^9, 
   3.8389800165308323`*^9}, {3.838980052213981*^9, 3.838980100967993*^9}, {
   3.8389803466206264`*^9, 3.838980377139561*^9}, {3.8389805293375573`*^9, 
   3.83898054982156*^9}, {3.838980642216855*^9, 3.8389806423202753`*^9}, 
   3.838980704633724*^9, {3.8389807361943846`*^9, 3.838980748573292*^9}, {
   3.838980876292096*^9, 3.8389809839855204`*^9}, {3.8389810343723817`*^9, 
   3.838981052319965*^9}, 3.8389811004057503`*^9, {3.838981176444544*^9, 
   3.838981256967248*^9}, {3.8389813364850674`*^9, 3.8389813476963167`*^9}, {
   3.8389813957643557`*^9, 3.8389814613958*^9}, {3.8389815738824406`*^9, 
   3.8389817489437704`*^9}, {3.838981948449819*^9, 3.838981950067354*^9}, {
   3.8393569649308805`*^9, 3.8393570699138064`*^9}, {3.839357145852449*^9, 
   3.839357203960518*^9}, {3.839357243932632*^9, 3.839357245242231*^9}, {
   3.839357301620901*^9, 3.8393573924278097`*^9}, 3.8393575132826953`*^9, {
   3.8393578552416534`*^9, 3.8393578618338766`*^9}, {3.839359320753386*^9, 
   3.839359346059767*^9}, {3.8393602026475353`*^9, 3.8393603017881517`*^9}, {
   3.83942809688715*^9, 3.839428212806492*^9}, {3.839431958981122*^9, 
   3.8394319803254495`*^9}, {3.839432037258*^9, 3.839432037326642*^9}, {
   3.839432103121444*^9, 3.8394321048239503`*^9}, {3.839432192428586*^9, 
   3.8394322066447754`*^9}, 3.839432239299589*^9, {3.8394323138493767`*^9, 
   3.839432327665306*^9}, 3.839432358994463*^9, {3.8394324578248467`*^9, 
   3.839432484932979*^9}, {3.8394325763910303`*^9, 3.839432580582559*^9}, {
   3.8395187798007283`*^9, 3.839518821909912*^9}, 3.839518875148583*^9, {
   3.8395189756913643`*^9, 3.839519082359242*^9}, {3.839519142004547*^9, 
   3.83951919207831*^9}, {3.839521780848177*^9, 3.839521806500095*^9}, {
   3.839521909589226*^9, 3.839521942996363*^9}, 3.839521998750819*^9, {
   3.8395220340562534`*^9, 3.839522137944013*^9}, {3.8395221709951324`*^9, 
   3.839522192882758*^9}, {3.8395226579532137`*^9, 3.839522696360197*^9}, {
   3.8395826535799284`*^9, 3.839582653706676*^9}, {3.8395908605463037`*^9, 
   3.839590888980703*^9}, 3.8395911739930162`*^9, {3.839591945299534*^9, 
   3.8395919454428864`*^9}, {3.8395921959806433`*^9, 3.839592199438594*^9}, {
   3.839592259623151*^9, 3.8395922858329473`*^9}, 3.8395923514520254`*^9, {
   3.839592471473362*^9, 3.839592471619735*^9}, {3.8395926209422183`*^9, 
   3.8395926753464713`*^9}, {3.839592749561859*^9, 3.8395927934024334`*^9}, {
   3.8395928637606916`*^9, 3.839592884851223*^9}, 3.839592942425869*^9, {
   3.8453893561874948`*^9, 3.8453893759246407`*^9}, 3.8453894263915596`*^9, 
   3.8453894584906197`*^9, {3.845389494596809*^9, 3.8453895641587124`*^9}, {
   3.845389615615509*^9, 3.845389636001499*^9}, {3.8453897233042407`*^9, 
   3.845389780695845*^9}, {3.8453898387305984`*^9, 3.845389859119454*^9}, {
   3.8453899149733143`*^9, 3.8453900670892878`*^9}, {3.845566786704673*^9, 
   3.8455668218665323`*^9}, {3.845566889937372*^9, 3.845567070483631*^9}, {
   3.845567205119375*^9, 3.845567213128336*^9}, {3.845567270118438*^9, 
   3.8455672847079535`*^9}, {3.8455673998663225`*^9, 3.845567422651112*^9}, {
   3.845567577458933*^9, 3.845567613963456*^9}, {3.845567871549438*^9, 
   3.8455679832961097`*^9}, {3.845568148568243*^9, 3.845568170566583*^9}, {
   3.8456304445049973`*^9, 3.845630479582086*^9}, {3.8456306000433197`*^9, 
   3.8456307250885057`*^9}, {3.845630779736402*^9, 3.8456308204754343`*^9}, {
   3.8456310787967243`*^9, 3.8456310919076695`*^9}, {3.845631128100527*^9, 
   3.8456312335194435`*^9}, {3.8456343430696*^9, 3.845634630815278*^9}, {
   3.8456348382077303`*^9, 3.8456348438216405`*^9}, {3.8456349916396155`*^9, 
   3.8456351328363914`*^9}, {3.8456358767096567`*^9, 3.845635890178936*^9}, {
   3.845635939295092*^9, 3.845635941197753*^9}, {3.845636000520771*^9, 
   3.8456360096091895`*^9}, {3.8456360432556005`*^9, 3.845636057000829*^9}, {
   3.845637004104349*^9, 3.845637011302223*^9}, {3.845637776706195*^9, 
   3.845637777931471*^9}, {3.8456392582367053`*^9, 3.8456393769681873`*^9}, {
   3.8456396102453814`*^9, 3.8456396177285366`*^9}, {3.8456397343622417`*^9, 
   3.845639739190237*^9}, {3.8456398824722137`*^9, 3.845639883714058*^9}, 
   3.8456403615518384`*^9, {3.8456429134017553`*^9, 3.8456429240608635`*^9}, {
   3.845642963238596*^9, 3.8456429662527876`*^9}, {3.8456458756204357`*^9, 
   3.845645878160095*^9}, 3.8456459509675665`*^9, {3.84597955129932*^9, 
   3.8459795603229218`*^9}, {3.8459807229058084`*^9, 3.84598079128061*^9}, {
   3.8459857391398263`*^9, 3.845985756171753*^9}, {3.8473682401668797`*^9, 
   3.847368331849612*^9}, {3.847368418653664*^9, 3.8473684371859818`*^9}, {
   3.847368492596898*^9, 3.8473685013669853`*^9}, {3.8473687187253103`*^9, 
   3.8473687188369055`*^9}, {3.847368914965672*^9, 3.847368915811639*^9}, {
   3.847369126932226*^9, 3.8473691453886604`*^9}, {3.8473692632717924`*^9, 
   3.847369265896412*^9}, {3.847369369265887*^9, 3.8473693702091303`*^9}, {
   3.8473812648028994`*^9, 3.8473812734659586`*^9}, {3.847381587391858*^9, 
   3.8473815874459696`*^9}, {3.84738202644963*^9, 3.8473820265331535`*^9}, {
   3.8473821778799715`*^9, 3.8473821795985065`*^9}, {3.847382343109564*^9, 
   3.847382346793274*^9}, {3.8618107242928905`*^9, 3.8618108575578194`*^9}, {
   3.8618109850791097`*^9, 3.8618110784062753`*^9}, {3.86181140076892*^9, 
   3.8618114109766145`*^9}, 3.861825863313692*^9, {3.8620535040256643`*^9, 
   3.862053504452704*^9}, {3.862054229969372*^9, 3.8620542390757065`*^9}, {
   3.8620543097846346`*^9, 3.862054381059415*^9}, {3.862054485358492*^9, 
   3.8620545897195873`*^9}},ExpressionUUID->"ed15d148-733c-4386-9344-\
7eadc13d9f93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Preview", " ", "of", " ", "the", " ", "results"}], ",", " ", 
    RowBox[{
    "the", " ", "final", " ", "plot", " ", "is", " ", "generated", " ", "in", 
     " ", "python"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"extract", "=", 
     RowBox[{"simulation", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ListDensityPlot", "[", 
    RowBox[{"extract", ",", 
     RowBox[{"Mesh", "->", "None"}], ",", 
     RowBox[{"InterpolationOrder", "->", "0"}], ",", 
     RowBox[{"PlotLegends", "->", 
      RowBox[{"BarLegend", "[", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "30"}], "}"}]}], "}"}], "]"}]}], ",", 
     RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{"Full", ",", "Full", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "30"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotRangeClipping", "->", "False"}], ",", 
     RowBox[{"ColorFunction", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<SunsetColors\>\"", "]"}], "[", 
         RowBox[{
          RowBox[{"0.9", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"#", "/", "30"}]}], ")"}]}], "+", "0.07"}], "]"}], "&"}],
        ")"}]}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8456346778211527`*^9, 3.8456346845948944`*^9}, {
   3.8456347471161594`*^9, 3.8456347972588315`*^9}, {3.8456358496197476`*^9, 
   3.8456358500996456`*^9}, {3.845635912181014*^9, 3.8456359123841963`*^9}, {
   3.8456377214324055`*^9, 3.845637732832384*^9}, {3.845639393614208*^9, 
   3.8456393951070986`*^9}, {3.8456396486551847`*^9, 3.845639658694315*^9}, {
   3.8456397556618214`*^9, 3.8456397557622128`*^9}, {3.845639828669756*^9, 
   3.8456398294372444`*^9}, {3.8456399060071287`*^9, 
   3.8456399060885963`*^9}, {3.8459807738374825`*^9, 3.845980779055842*^9}, {
   3.8473684010169663`*^9, 3.847368401357546*^9}, {3.8473687389332037`*^9, 
   3.847368787020938*^9}, {3.8473688251427555`*^9, 3.8473688419422383`*^9}, {
   3.847369026589077*^9, 3.8473690267727094`*^9}, {3.8618108904989047`*^9, 
   3.8618108919294233`*^9}, {3.8618114663967633`*^9, 3.861811478646655*^9}, {
   3.86205351121708*^9, 3.8620535334480515`*^9}, {3.86205424524285*^9, 
   3.862054246721939*^9}, 
   3.862054581538452*^9},ExpressionUUID->"cb55f92b-0108-47d1-b608-\
f2e5ed016aa2"]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{-2.4, Automatic}, {Automatic, 3.5999999999999996`}},
Magnification:>0.9 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"efc95f3c-a8db-47be-b306-a974c92e9918"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 17958, 327, 593, "Input",ExpressionUUID->"ed15d148-733c-4386-9344-7eadc13d9f93"],
Cell[18519, 349, 2726, 62, 95, "Input",ExpressionUUID->"cb55f92b-0108-47d1-b608-f2e5ed016aa2"]
}
]
*)

